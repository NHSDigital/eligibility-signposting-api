AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: SAM Template using pre-built Zip for Eligibility Signposting API

Globals:
  Function:
    Timeout: 30
    MemorySize: 256
    Runtime: python3.13
    Handler: eligibility_signposting_api.app.lambda_handler
    Environment:
      Variables:
        DYNAMODB_ENDPOINT: http://moto-server:5000
        S3_ENDPOINT: http://moto-server:5000
        SECRET_MANAGER_ENDPOINT: http://moto-server:5000
        FIREHOSE_ENDPOINT: http://moto-server:5000
        AWS_REGION: eu-west-1
        PERSON_TABLE_NAME: test_eligibility_datastore
        RULES_BUCKET_NAME: test-rules-bucket
        CONSUMER_MAPPING_BUCKET_NAME: test-consumer-mapping-bucket
        AUDIT_BUCKET_NAME: test-audit-bucket

Resources:
  EligibilityFunction:
    Type: AWS::Serverless::Function
    Properties:
      # Point this to the location of your zip file relative to the template
      CodeUri: ../dist/lambda.zip
      Events:
        GetEligibility:
          Type: Api
          Properties:
            Path: /patient-check/{id}
            Method: get
